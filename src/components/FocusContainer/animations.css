/* Focus view transition animations */

/* ============================================================
   SPATIAL ZOOM TRANSITIONS (Tier 3 - FLIP-inspired)

   The spatial zoom creates visual continuity between orga and
   team views using clip-path circle reveal.

   Zoom-in: clip-path on new view expands from clicked node to viewport.
   Zoom-out: clip-path on old view contracts from viewport to node position.

   Duration: 300ms (snappy, macOS Mission Control feel)
   Easing: cubic-bezier(0.2, 0, 0, 1) - fast start, smooth decel
   ============================================================ */

/* --- Old/new view layers during transition --- */

.zoom-layer-old {
  position: absolute;
  inset: 0;
  will-change: transform, opacity;
}

.zoom-layer-new {
  position: absolute;
  inset: 0;
  will-change: transform, opacity;
}

/* Zoom-in: old view scales up toward click point and fades */
.zoom-layer-old.zoom-in-exit {
  animation: zoomInExit 300ms cubic-bezier(0.2, 0, 0, 1) forwards;
}


/* --- Keyframes --- */

@keyframes zoomInExit {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(2.5);
  }
}


/* --- Fallback for non-orga-team transitions --- */

@keyframes fadeScaleIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes fadeScaleInFromSmall {
  from {
    opacity: 0;
    transform: scale(0.3);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes fadeScaleInFromLarge {
  from {
    opacity: 0;
    transform: scale(2);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* ============================================================
   VIEW MODE FLIP (3D coin flip - visual/manage toggle)
   ============================================================ */

/* Container with perspective for 3D effect */
.flip-container {
  perspective: 1200px;
  transform-style: preserve-3d;
}

/* The rotating element */
.flip-card {
  transform-style: preserve-3d;
  transition: transform 500ms cubic-bezier(0.2, 0.8, 0.3, 1);
  will-change: transform;
}

/* Flip states */
.flip-card.visual {
  transform: rotateY(0deg);
}

.flip-card.manage {
  transform: rotateY(180deg);
}

/* Both faces share common positioning */
.flip-face {
  position: absolute;
  inset: 0;
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* Front face (visual) - no rotation needed */
.flip-face-visual {
  transform: rotateY(0deg);
}

/* Back face (manage) - pre-rotated 180deg so it shows correctly when flipped */
.flip-face-manage {
  transform: rotateY(180deg);
}

/* ============================================================
   LEGACY SWAP ANIMATIONS (kept for backwards compatibility)
   ============================================================ */

@keyframes swapOutUp {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(-24px) scale(0.98);
  }
}

@keyframes swapInUp {
  from {
    opacity: 0;
    transform: translateY(24px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

@keyframes swapOutDown {
  from {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
  to {
    opacity: 0;
    transform: translateY(24px) scale(0.98);
  }
}

@keyframes swapInDown {
  from {
    opacity: 0;
    transform: translateY(-24px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.swap-out-up {
  animation: swapOutUp 175ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.swap-in-up {
  animation: swapInUp 175ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.swap-out-down {
  animation: swapOutDown 175ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

.swap-in-down {
  animation: swapInDown 175ms cubic-bezier(0.4, 0, 0.2, 1) forwards;
}

/* ============================================================
   REDUCED MOTION PREFERENCES
   ============================================================ */

@media (prefers-reduced-motion: reduce) {
  .focus-view {
    animation: none !important;
    transition: opacity 150ms ease-out !important;
    transform: none !important;
  }

  /* Disable spatial zoom for reduced motion */
  .zoom-layer-old,
  .zoom-layer-new {
    animation: none !important;
    clip-path: none !important;
    will-change: auto !important;
  }
  .zoom-layer-old.zoom-in-exit {
    opacity: 0 !important;
    transform: none !important;
    transition: opacity 150ms ease-out !important;
  }

  .swap-out-up, .swap-in-up, .swap-out-down, .swap-in-down {
    animation: none !important;
    opacity: 1 !important;
    transform: none !important;
  }

  /* Disable 3D flip animation for reduced motion */
  .flip-card {
    transition: none !important;
    transform: none !important;
  }
  .flip-face {
    backface-visibility: visible !important;
    -webkit-backface-visibility: visible !important;
    transform: none !important;
  }
  .flip-face-visual {
    opacity: 1;
  }
  .flip-face-manage {
    opacity: 0;
  }
  .flip-card.manage .flip-face-visual {
    opacity: 0;
  }
  .flip-card.manage .flip-face-manage {
    opacity: 1;
  }
}
